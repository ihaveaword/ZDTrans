# 设置界面用户体验优化

## 更新说明

根据用户反馈，对设置界面进行了用户体验优化，让操作更加直观和便捷。

## 优化内容

### 1. 🎓 学科领域简化

#### 优化前
- 下拉框 + 单独的 `+` 按钮
- 需要两步操作：输入 → 点击按钮添加
- 不够直观，容易困惑

#### 优化后  
- **直接可编辑的下拉框**
- 默认显示"通用"
- 直接输入或选择，无需额外操作
- 更加简洁明了

**使用方式**：
```
方式1: 下拉选择预设领域（通用、计算机科学、医学等）
方式2: 直接在框内输入自定义领域（如：量子计算）
```

**示例**：
- 输入"量子计算" → 保存 → 完成 ✅
- 选择"计算机科学" → 保存 → 完成 ✅

### 2. 📝 关键词输入框扩大

#### 优化前
- 单行文本框 (QLineEdit)
- 高度有限，不方便输入多个关键词
- 内容较多时看不全

#### 优化后
- **多行文本框 (QTextEdit)**
- 高度提升到 80px
- 可以换行查看
- 支持更多关键词

**效果对比**：

优化前（单行）：
```
┌──────────────────────────────────────┐
│ 机器学习, 神经网络, 深度学习, Tra... │
└──────────────────────────────────────┘
```

优化后（多行）：
```
┌──────────────────────────────────────┐
│ 机器学习, 神经网络, 深度学习,       │
│ Transformer, BERT, GPT,              │
│ 自然语言处理, 计算机视觉             │
└──────────────────────────────────────┘
```

### 3. 💡 提示文本优化

**学科领域**：
- 占位符：`直接输入或选择学科领域`
- 工具提示：`可直接输入自定义学科领域，例如：量子计算、区块链技术`

**关键词**：
- 占位符：
  ```
  例如：机器学习, 神经网络, 深度学习, Transformer, BERT
  用逗号分隔多个关键词，支持中英文
  ```
- 工具提示：`输入专业领域的关键词，帮助AI更准确地翻译术语`

## 界面布局对比

### 优化前
```
┌─ 翻译配置 ─────────────────────────┐
│ 学科领域: [通用 ▼] [+]             │
│ 自定义说明: [____________]         │
│ 关键词: [机器学习, 神经网络...]    │
│ □ 学术模式                         │
│ ☑ 保留术语原文                     │
└────────────────────────────────────┘
```

### 优化后
```
┌─ 翻译配置 ─────────────────────────┐
│ 学科领域: [通用 ▼]                 │
│            ↑ 可直接输入             │
│                                    │
│ 自定义说明: ┌──────────────────┐   │
│            │ 例如：这是深度...  │   │
│            └──────────────────┘   │
│                                    │
│ 关键词:     ┌──────────────────┐   │
│            │ 例如：机器学习,    │   │
│            │ 神经网络...        │   │  ← 更大的输入区域
│            └──────────────────┘   │
│                                    │
│ □ 学术模式                         │
│ ☑ 保留术语原文                     │
└────────────────────────────────────┘
```

## 技术实现

### 修改文件
`src/settings.py`

### 关键改动

#### 1. 学科领域简化
```python
# 移除 + 按钮，直接使用可编辑下拉框
self.domain_combo = QComboBox()
self.domain_combo.setEditable(True)  # 允许直接编辑
self.domain_combo.addItems([
    "通用", "计算机科学", "医学", "生物学", 
    "物理学", "化学", "数学", "工程学", "经济学"
])
self.domain_combo.setPlaceholderText("直接输入或选择学科领域")
self.domain_combo.setToolTip("可直接输入自定义学科领域，例如：量子计算、区块链技术")

# 直接添加到表单，无需额外按钮
trans_layout.addRow("学科领域:", self.domain_combo)
```

#### 2. 关键词改为多行文本框
```python
# 从 QLineEdit 改为 QTextEdit
self.keywords_edit = QTextEdit()
self.keywords_edit.setPlaceholderText(
    "例如：机器学习, 神经网络, 深度学习, Transformer, BERT\n"
    "用逗号分隔多个关键词，支持中英文"
)
self.keywords_edit.setMaximumHeight(80)  # 设置合适的高度
self.keywords_edit.setToolTip("输入专业领域的关键词，帮助AI更准确地翻译术语")
```

#### 3. 配置读写适配
```python
# 加载配置
self.keywords_edit.setPlainText(trans_config.get('keywords', ''))

# 保存配置
'keywords': self.keywords_edit.toPlainText().strip()
```

### 删除的代码
- ❌ `add_domain_btn` 按钮及相关代码
- ❌ `_add_custom_domain()` 方法
- ❌ `custom_domains` 配置项（不再需要）

## 用户操作流程

### 场景 1：使用预设领域
```
1. 打开设置
2. 学科领域下拉选择"计算机科学"
3. 保存
```

### 场景 2：使用自定义领域
```
1. 打开设置
2. 学科领域直接输入"量子计算"
3. 保存
```

### 场景 3：输入多个关键词
```
1. 打开设置
2. 关键词框输入：
   机器学习, 神经网络, 深度学习,
   Transformer, BERT, GPT,
   自然语言处理
3. 保存
```

## 优势总结

### 简化操作
- ✅ 从 2 步减少到 1 步（学科领域）
- ✅ 无需额外按钮，界面更清爽
- ✅ 操作更直观，符合用户预期

### 提升效率
- ✅ 关键词一次性看到更多内容
- ✅ 支持换行，组织更清晰
- ✅ 减少滚动操作

### 用户体验
- ✅ 提示信息更详细
- ✅ 占位符示例更实用
- ✅ 工具提示说明清楚

## 配置文件变化

### 优化前
```json
{
  "translation": {
    "domain": "computer_science",
    "custom_domains": ["量子计算", "区块链技术"],  ← 不再需要
    "keywords": "机器学习, 神经网络"
  }
}
```

### 优化后
```json
{
  "translation": {
    "domain": "量子计算",  ← 直接保存输入的值
    "keywords": "量子比特, 量子门, 叠加态"
  }
}
```

**说明**：
- 如果输入的是预设领域，保存为对应的 key（如 `computer_science`）
- 如果输入的是自定义领域，直接保存文本（如 `量子计算`）
- 不再需要单独的 `custom_domains` 字段

## 兼容性

- ✅ 旧配置文件完全兼容
- ✅ 保存后自动转换为新格式
- ✅ 不影响现有功能

## 测试

### 测试步骤
1. 运行 `python test_settings_scroll.py`
2. 测试学科领域输入
3. 测试关键词多行输入
4. 保存并验证配置文件

### 测试点
- ✅ 可以选择预设领域
- ✅ 可以输入自定义领域
- ✅ 关键词支持多行
- ✅ 配置正确保存
- ✅ 配置正确加载

## 相关文档

- [自定义学科领域指南](CUSTOM_DOMAIN_GUIDE.md)
- [关键词使用指南](KEYWORDS_GUIDE.md)
- [设置窗口滚动优化](SETTINGS_SCROLL_UPDATE.md)

---

**更新日期**: 2025-10-31  
**版本**: v1.2.2  
**类型**: UX优化
